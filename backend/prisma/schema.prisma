generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Admin {
  id       String @id @default(uuid())
  email    String @unique
  password String // Hashed
}

model Meeting {
  id                    String   @id @default(uuid())
  name                  String?
  s3_url                String

  // Transcription data - stored at each stage
  client_transcript     String?  // Captions scraped from meeting
  elevenlabs_transcript String?  // Raw transcription from ElevenLabs
  raw_transcript        String?  // Final combined transcript with speakers

  // Summarization data
  summary               String?
  action_items          String?  // Stored as JSON string
  sentiment             String?  // Sentiment analysis result

  // Metadata
  duration              Int?
  audio_file_size       Int?     // Size of uploaded audio file in bytes
  transcription_words   Int?     // Word count from ElevenLabs

  // Processing tracking
  status                String?  @default("processing")
  processing_stage      String?  // Track current stage: uploaded, transcribing, summarizing, completed
  error_log             String?  // Store any errors encountered

  created_at            DateTime @default(now())
  updated_at            DateTime @updatedAt
  deleted_at            DateTime?  // Soft delete timestamp

  segments              SpeakerSegment[]
}

model SpeakerSegment {
  id           String   @id @default(uuid())
  meeting_id   String
  meeting      Meeting  @relation(fields: [meeting_id], references: [id], onDelete: Cascade)
  speaker_name String
  text         String
  timestamp    DateTime
}
